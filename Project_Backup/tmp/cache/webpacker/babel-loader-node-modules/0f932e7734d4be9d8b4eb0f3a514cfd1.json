{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport XLSX from 'xlsx';\nexport default {\n  props: {\n    appData: {\n      type: Object,\n      required: true\n    }\n  },\n  methods: {\n    submit: function submit(e) {\n      this.appData.message = '';\n\n      if (this.appData.fileExcel && (this.appData.fileGoogle || this.appData.fileYahoo)) {\n        this.appData.message = this.$t(\"error.sure\");\n        this.appData.isImportFile = true;\n        var address_of_cell = this.$t(\"row_check.excel\");\n        this.classify(this.checkFile(address_of_cell, this.appData.message, this.appData.fileExcel));\n\n        if (this.appData.isSelectYahooFile) {\n          var address_of_cell = this.$t(\"row_check.yahoo\");\n          var key_check = this.checkFile(address_of_cell, this.appData.message, this.appData.fileYahoo);\n\n          if (this.appData.isSearch && !key_check.includes(this.$t(\"key_search.search_yahoo\")) || (this.appData.isVideo || this.appData.isDisplay) && !key_search.includes(this.$t(\"key_search.video_display_yahoo\"))) {\n            this.appData.message = this.$t(\"error.not_match\");\n          }\n        }\n      } else {\n        this.appData.message = this.$t(\"error.error_missing\");\n        this.appData.isImportFile = false;\n      }\n    },\n    checkFile: function checkFile(address_of_cell, message, file) {\n      var workbook = XLSX.read(file, {\n        type: 'base64'\n      });\n      var first_sheet_name = workbook.SheetNames[0];\n      var worksheet = workbook.Sheets[first_sheet_name];\n      console.log(worksheet);\n      var desired_cell = worksheet[address_of_cell];\n      var desired_value = desired_cell ? desired_cell.v : undefined;\n      return desired_value;\n    },\n    classify: function classify(value) {\n      if (value.includes(this.$t(\"key_search.search\"))) {\n        this.appData.isSearch = true;\n      } else if (value.includes(this.$t(\"key_search.video\"))) {\n        this.appData.isVideo = true;\n      } else if (value.includes(this.$t(\"key_search.display\"))) {\n        this.appData.isDisplay = true;\n      } else {\n        this.appData.message = this.$t(\"error.not_find\");\n      }\n    }\n  }\n};","map":{"version":3,"sources":["DownloadButton.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n<div>\n  <div class=\"row\">\n    <div class=\"col-md-12 text-center\">\n      <button @click=\"submit\" type=\"button\" class=\"btn btn-info button-size\" data-toggle=\"modal\" data-target=\"#message\">{{ $t(\"order_comparer.submit\") }}</button>\n      <span class=\"submit-execution\">{{ $t(\"order_comparer.desc_submit\") }}</span>\n    </div>\n  </div>\n\n  <div class=\"modal fade\" id=\"message\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"message\" aria-hidden=\"true\">\n    <div class=\"modal-dialog\" role=\"document\">\n      <div class=\"modal-content\">\n        \n        <div class=\"modal-body\">\n          <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n          </button>\n          <h5 v-html=\"appData.message\" class=\"modal-title\" id=\"message\"></h5>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">{{ !appData.isImportFile ? $t(\"order_comparer.yes\") : $t(\"order_comparer.no\") }}</button>\n          <button type=\"button\" class=\"btn btn-primary\" v-show=\"appData.isImportFile\">{{ $t(\"order_comparer.ok\") }}</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n</div>\n</template>\n<script>\n  import XLSX from 'xlsx'\n  export default {\n    props: {\n      appData: {\n        type: Object,\n        required: true\n      }\n    },\n\n    methods : {\n      submit: function(e) {\n        this.appData.message = '';\n        if (this.appData.fileExcel && (this.appData.fileGoogle || this.appData.fileYahoo) ) {\n          this.appData.message = this.$t(\"error.sure\");\n          this.appData.isImportFile = true;\n          var address_of_cell = this.$t(\"row_check.excel\");\n          this.classify(this.checkFile(address_of_cell,this.appData.message,this.appData.fileExcel));\n          if (this.appData.isSelectYahooFile) {\n            var address_of_cell = this.$t(\"row_check.yahoo\");\n            var key_check = this.checkFile(address_of_cell,this.appData.message,this.appData.fileYahoo);\n            if ((this.appData.isSearch && !key_check.includes(this.$t(\"key_search.search_yahoo\"))) || ((this.appData.isVideo || this.appData.isDisplay) && !key_search.includes(this.$t(\"key_search.video_display_yahoo\")))) {\n              this.appData.message = this.$t(\"error.not_match\");\n            }\n          }\n        } else {\n          this.appData.message = this.$t(\"error.error_missing\");\n          this.appData.isImportFile = false;\n        }\n      },\n\n      checkFile: function(address_of_cell,message,file) {\n        const workbook = XLSX.read(file, {type:'base64'});\n        const first_sheet_name = workbook.SheetNames[0];\n        const worksheet = workbook.Sheets[first_sheet_name];\n        console.log(worksheet);\n        var desired_cell = worksheet[address_of_cell];\n        var desired_value = (desired_cell ? desired_cell.v : undefined);\n        return desired_value;\n      },\n\n      classify: function(value) {\n        if (value.includes(this.$t(\"key_search.search\"))) {\n          this.appData.isSearch = true;\n        } else if (value.includes(this.$t(\"key_search.video\"))) {\n          this.appData.isVideo = true;\n        } else if (value.includes(this.$t(\"key_search.display\"))) {\n          this.appData.isDisplay = true;\n        } else {\n          this.appData.message = this.$t(\"error.not_find\");\n        }\n      }\n    }\n}\n</script>\n<style>\n  .submit-execution {\n    font-size: 14px;\n    padding-left: 20px;\n  }\n</style>"],"sourceRoot":"app/javascript/components"},"metadata":{},"sourceType":"module"}