{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport XLSX from 'xlsx';\nexport default {\n  props: {\n    appData: {\n      type: Object,\n      required: true\n    }\n  },\n  methods: {\n    submit: function submit(e) {\n      if (this.appData.fileExcel && (this.appData.fileGoogle || this.appData.fileYahoo)) {\n        this.appData.message = this.$t(\"error.sure\");\n        this.appData.isImportFile = true;\n        var address_of_cell = this.$t(\"row_check.excel\");\n        this.classifyFile(this.getFileFmt(address_of_cell, this.appData.fileExcel));\n\n        if (this.appData.isSelectYahooFile && !this.appData.isNothing) {\n          var worksheet = this.getSheet(this.appData.fileYahoo);\n          var key_check = this.getFileHeader(worksheet);\n          console.log(key_check.includes(this.$t(\"key_search.search_yahoo\")));\n          console.log(key_check);\n\n          if (this.appData.isSearch && !key_check.includes(this.$t(\"key_search.search_yahoo\")) || (this.appData.isVideo || this.appData.isDisplay) && !key_search.includes(this.$t(\"key_search.video_display_yahoo\"))) {\n            return this.appData.message = this.$t(\"error.not_match\");\n          }\n        }\n      } else {\n        this.appData.message = this.$t(\"error.error_missing\");\n        this.appData.isImportFile = false;\n      }\n    },\n    getSheet: function getSheet(file) {\n      var workbook = XLSX.read(file, {\n        type: 'binary'\n      });\n      var first_sheet_name = workbook.SheetNames[0];\n      var worksheet = workbook.Sheets[first_sheet_name];\n      return worksheet;\n    },\n    getFileFmt: function getFileFmt(address_of_cell, file) {\n      var worksheet = this.getSheet(file);\n      var desired_cell = worksheet[address_of_cell];\n      var desired_value = desired_cell ? desired_cell.v : undefined;\n      return desired_value;\n    },\n    getFileHeader: function getFileHeader(sheet) {\n      var headers = [];\n      var range = XLSX.utils.decode_range(sheet['!ref']);\n      var C,\n          R = range.s.r;\n\n      for (C = range.s.c; C <= range.e.c; ++C) {\n        var cell = sheet[XLSX.utils.encode_cell({\n          c: C,\n          r: R\n        })];\n        var hdr = \"UNKNOWN \" + C;\n        if (cell && cell.t) hdr = XLSX.utils.format_cell(cell);\n        headers.push(hdr);\n      }\n\n      return headers;\n    },\n    classifyFile: function classifyFile(value) {\n      if (value != undefined) {\n        if (value.includes(this.$t(\"key_search.search\"))) {\n          this.appData.isSearch = true;\n        } else if (value.includes(this.$t(\"key_search.video\"))) {\n          this.appData.isVideo = true;\n        } else if (value.includes(this.$t(\"key_search.display\"))) {\n          this.appData.isDisplay = true;\n        } else {\n          this.appData.message = this.$t(\"error.not_find\");\n        }\n      } else {\n        this.appData.isNothing = true;\n        this.appData.isImportFile = false;\n        this.appData.message = \"File Content Error\";\n      }\n    }\n  }\n};","map":{"version":3,"sources":["DownloadButton.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA,OAAA,IAAA,MAAA,MAAA;AACA,eAAA;AACA,EAAA,KAAA,EAAA;AACA,IAAA,OAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,QAAA,EAAA;AAFA;AADA,GADA;AAQA,EAAA,OAAA,EAAA;AACA,IAAA,MAAA,EAAA,gBAAA,CAAA,EAAA;AACA,UAAA,KAAA,OAAA,CAAA,SAAA,KAAA,KAAA,OAAA,CAAA,UAAA,IAAA,KAAA,OAAA,CAAA,SAAA,CAAA,EAAA;AACA,aAAA,OAAA,CAAA,OAAA,GAAA,KAAA,EAAA,CAAA,YAAA,CAAA;AACA,aAAA,OAAA,CAAA,YAAA,GAAA,IAAA;AACA,YAAA,eAAA,GAAA,KAAA,EAAA,CAAA,iBAAA,CAAA;AACA,aAAA,YAAA,CAAA,KAAA,UAAA,CAAA,eAAA,EAAA,KAAA,OAAA,CAAA,SAAA,CAAA;;AACA,YAAA,KAAA,OAAA,CAAA,iBAAA,IAAA,CAAA,KAAA,OAAA,CAAA,SAAA,EAAA;AACA,cAAA,SAAA,GAAA,KAAA,QAAA,CAAA,KAAA,OAAA,CAAA,SAAA,CAAA;AACA,cAAA,SAAA,GAAA,KAAA,aAAA,CAAA,SAAA,CAAA;AACA,UAAA,OAAA,CAAA,GAAA,CAAA,SAAA,CAAA,QAAA,CAAA,KAAA,EAAA,CAAA,yBAAA,CAAA,CAAA;AACA,UAAA,OAAA,CAAA,GAAA,CAAA,SAAA;;AACA,cAAA,KAAA,OAAA,CAAA,QAAA,IAAA,CAAA,SAAA,CAAA,QAAA,CAAA,KAAA,EAAA,CAAA,yBAAA,CAAA,CAAA,IAAA,CAAA,KAAA,OAAA,CAAA,OAAA,IAAA,KAAA,OAAA,CAAA,SAAA,KAAA,CAAA,UAAA,CAAA,QAAA,CAAA,KAAA,EAAA,CAAA,gCAAA,CAAA,CAAA,EAAA;AACA,mBAAA,KAAA,OAAA,CAAA,OAAA,GAAA,KAAA,EAAA,CAAA,iBAAA,CAAA;AACA;AACA;AACA,OAdA,MAcA;AACA,aAAA,OAAA,CAAA,OAAA,GAAA,KAAA,EAAA,CAAA,qBAAA,CAAA;AACA,aAAA,OAAA,CAAA,YAAA,GAAA,KAAA;AACA;AACA,KApBA;AAqBA,IAAA,QArBA,oBAqBA,IArBA,EAqBA;AACA,UAAA,QAAA,GAAA,IAAA,CAAA,IAAA,CAAA,IAAA,EAAA;AAAA,QAAA,IAAA,EAAA;AAAA,OAAA,CAAA;AACA,UAAA,gBAAA,GAAA,QAAA,CAAA,UAAA,CAAA,CAAA,CAAA;AACA,UAAA,SAAA,GAAA,QAAA,CAAA,MAAA,CAAA,gBAAA,CAAA;AACA,aAAA,SAAA;AACA,KA1BA;AA4BA,IAAA,UAAA,EAAA,oBAAA,eAAA,EAAA,IAAA,EAAA;AACA,UAAA,SAAA,GAAA,KAAA,QAAA,CAAA,IAAA,CAAA;AACA,UAAA,YAAA,GAAA,SAAA,CAAA,eAAA,CAAA;AACA,UAAA,aAAA,GAAA,YAAA,GAAA,YAAA,CAAA,CAAA,GAAA,SAAA;AACA,aAAA,aAAA;AAEA,KAlCA;AAoCA,IAAA,aAAA,EAAA,uBAAA,KAAA,EAAA;AACA,UAAA,OAAA,GAAA,EAAA;AACA,UAAA,KAAA,GAAA,IAAA,CAAA,KAAA,CAAA,YAAA,CAAA,KAAA,CAAA,MAAA,CAAA,CAAA;AACA,UAAA,CAAA;AAAA,UAAA,CAAA,GAAA,KAAA,CAAA,CAAA,CAAA,CAAA;;AACA,WAAA,CAAA,GAAA,KAAA,CAAA,CAAA,CAAA,CAAA,EAAA,CAAA,IAAA,KAAA,CAAA,CAAA,CAAA,CAAA,EAAA,EAAA,CAAA,EAAA;AACA,YAAA,IAAA,GAAA,KAAA,CAAA,IAAA,CAAA,KAAA,CAAA,WAAA,CAAA;AAAA,UAAA,CAAA,EAAA,CAAA;AAAA,UAAA,CAAA,EAAA;AAAA,SAAA,CAAA,CAAA;AACA,YAAA,GAAA,GAAA,aAAA,CAAA;AACA,YAAA,IAAA,IAAA,IAAA,CAAA,CAAA,EAAA,GAAA,GAAA,IAAA,CAAA,KAAA,CAAA,WAAA,CAAA,IAAA,CAAA;AACA,QAAA,OAAA,CAAA,IAAA,CAAA,GAAA;AACA;;AACA,aAAA,OAAA;AACA,KA/CA;AAiDA,IAAA,YAAA,EAAA,sBAAA,KAAA,EAAA;AACA,UAAA,KAAA,IAAA,SAAA,EAAA;AACA,YAAA,KAAA,CAAA,QAAA,CAAA,KAAA,EAAA,CAAA,mBAAA,CAAA,CAAA,EAAA;AACA,eAAA,OAAA,CAAA,QAAA,GAAA,IAAA;AACA,SAFA,MAEA,IAAA,KAAA,CAAA,QAAA,CAAA,KAAA,EAAA,CAAA,kBAAA,CAAA,CAAA,EAAA;AACA,eAAA,OAAA,CAAA,OAAA,GAAA,IAAA;AACA,SAFA,MAEA,IAAA,KAAA,CAAA,QAAA,CAAA,KAAA,EAAA,CAAA,oBAAA,CAAA,CAAA,EAAA;AACA,eAAA,OAAA,CAAA,SAAA,GAAA,IAAA;AACA,SAFA,MAEA;AACA,eAAA,OAAA,CAAA,OAAA,GAAA,KAAA,EAAA,CAAA,gBAAA,CAAA;AACA;AACA,OAVA,MAUA;AACA,aAAA,OAAA,CAAA,SAAA,GAAA,IAAA;AACA,aAAA,OAAA,CAAA,YAAA,GAAA,KAAA;AACA,aAAA,OAAA,CAAA,OAAA,GAAA,oBAAA;AACA;AACA;AAjEA;AARA,CAAA","sourcesContent":["<template>\n<div>\n  <div class=\"row\">\n    <div class=\"col-md-12 text-center\">\n      <button @click=\"submit\" type=\"button\" class=\"btn btn-info button-size\" data-toggle=\"modal\" data-target=\"#message\">{{ $t(\"order_comparer.submit\") }}</button>\n      <span class=\"submit-execution\">{{ $t(\"order_comparer.desc_submit\") }}</span>\n    </div>\n  </div>\n\n  <div class=\"modal fade\" id=\"message\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"message\" aria-hidden=\"true\">\n    <div class=\"modal-dialog\" role=\"document\">\n      <div class=\"modal-content\">\n        \n        <div class=\"modal-body\">\n          <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n          </button>\n          <h5 v-html=\"appData.message\" class=\"modal-title\" id=\"message\"></h5>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" data-dismiss=\"modal\" v-bind:class=\"{ 'btn btn-secondary': appData.isImportFile, 'btn btn-primary': !appData.isImportFile }\">{{ !appData.isImportFile ? $t(\"order_comparer.ok\") : $t(\"order_comparer.no\") }}</button>\n          <button type=\"button\" class=\"btn btn-primary\" v-show=\"appData.isImportFile\">{{ $t(\"order_comparer.yes\") }}</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n</div>\n</template>\n<script>\n  import XLSX from 'xlsx'\n  export default {\n    props: {\n      appData: {\n        type: Object,\n        required: true\n      }\n    },\n\n    methods : {\n      submit: function(e) {\n        if (this.appData.fileExcel && (this.appData.fileGoogle || this.appData.fileYahoo) ) {\n          this.appData.message = this.$t(\"error.sure\");\n          this.appData.isImportFile = true;\n          var address_of_cell = this.$t(\"row_check.excel\");\n          this.classifyFile(this.getFileFmt(address_of_cell,this.appData.fileExcel));\n          if (this.appData.isSelectYahooFile && !this.appData.isNothing) {\n            var worksheet = this.getSheet(this.appData.fileYahoo);\n            var key_check = this.getFileHeader(worksheet);\n            console.log(key_check.includes(this.$t(\"key_search.search_yahoo\")));\n            console.log(key_check);\n            if ((this.appData.isSearch && !key_check.includes(this.$t(\"key_search.search_yahoo\"))) || ((this.appData.isVideo || this.appData.isDisplay) && !key_search.includes(this.$t(\"key_search.video_display_yahoo\")))) {\n              return this.appData.message = this.$t(\"error.not_match\");\n            }\n          }\n        } else {\n          this.appData.message = this.$t(\"error.error_missing\");\n          this.appData.isImportFile = false;\n        }\n      },\n      getSheet(file) {\n        const workbook = XLSX.read(file, {type:'binary'});\n        const first_sheet_name = workbook.SheetNames[0];\n        const worksheet = workbook.Sheets[first_sheet_name];\n        return worksheet;\n      },\n\n      getFileFmt: function(address_of_cell,file) {\n        var worksheet = this.getSheet(file);\n        var desired_cell = worksheet[address_of_cell];\n        var desired_value = (desired_cell ? desired_cell.v : undefined);\n        return desired_value;\n        \n      },\n\n      getFileHeader: function(sheet) {\n        var headers = [];\n        var range = XLSX.utils.decode_range(sheet['!ref']);\n        var C, R = range.s.r;\n        for(C = range.s.c; C <= range.e.c; ++C) {\n            var cell = sheet[XLSX.utils.encode_cell({c:C, r:R})]\n            var hdr = \"UNKNOWN \" + C;\n            if(cell && cell.t) hdr = XLSX.utils.format_cell(cell);\n            headers.push(hdr);\n        }\n        return headers;\n      },\n\n      classifyFile: function(value) {\n        if (value != undefined) {\n          if (value.includes(this.$t(\"key_search.search\"))) {\n            this.appData.isSearch = true;\n          } else if (value.includes(this.$t(\"key_search.video\"))) {\n            this.appData.isVideo = true;\n          } else if (value.includes(this.$t(\"key_search.display\"))) {\n            this.appData.isDisplay = true;\n          } else {\n            this.appData.message = this.$t(\"error.not_find\");\n          }\n        } else {\n          this.appData.isNothing = true;\n          this.appData.isImportFile = false;\n          this.appData.message = \"File Content Error\"\n        }\n      }\n    }\n}\n</script>\n<style>\n  .submit-execution {\n    font-size: 14px;\n    padding-left: 20px;\n  }\n</style>"],"sourceRoot":"app/javascript/components"},"metadata":{},"sourceType":"module"}